const t=1e4,r=(r,s,e,h)=>o=>{const{pitch:n,length:a}=o||{pitch:0,length:1};let m=0;const i=2**((n-12*r)/12)*1.24,c=Math.pow(.9999,2/a);return()=>{if(0===n)return 0;if(++m,m>=a*t)return;const r=m>a*t*s?Math.pow(c,m-a*t*s):1;return h(m,i)*r*e}},s=t=>{const r=t.split(",").reduce((t,r)=>{const[s,e]=r.split("");return(parseInt(e)||1)+t},0),s=Array.from({length:r});let e=0;return t.split(",").forEach(t=>{const[r,h]=t.split(""),o=parseInt(r,32),n=isNaN(parseInt(h))?1:parseInt(h);s[e]={pitch:isNaN(o)?0:o,length:n},e+=n}),{t:s,h:r}},e={o:r(0,.4,.3,(t,r)=>(t*r/2&202)/120-.75),...s("r6,q1,r1,t1,r1,q1,o1,r2,r1,o1,r6,q1,r1,o1,m1,j1,k1,m9,k1,j1,h1,j1,k1,m1,o1,m9,o1,q1,o1,m1,k1,j1,h1,j1,h1,f4,f1,h1,j1,~1,k1,~1,h4,mh,~3,t7,r1,q1,o1,q1,r1,t1,r1,q3,r1,q1,o1,r1,q1,o1,k3,k1,k1,k1,~1,o1,~1,r1,o1,q1,m1,k2,k1,k1,k1,~1,o1,~1,q1,m1,o1,k1,h2,h1,f1,h6,h1,h1,h1,~1,k1,~1,o1,k1,m1,j1,h2,h1,f1,h6,h1,f1,h2,j1,k1,m9,k1,j1,h1,f2,m1,m1,m1,~1,m1,m1,m1,~1,m1,~1,m1,~1,m1,m1,m1,~1,m1,m1,m1,m1,m1,m1,m1")},h={o:r(4,.1,2,(t,r)=>Math.tan(Math.cbrt(Math.sin(t*r/30)))),...s("a4,m4,a4,a4,m4,a2,a2,".repeat(8).slice(0,-1))};let o=[{...h,...s("a4,m4,a4,a4,m4,a2,a2")}],n=[];const a=(r,s,e)=>{r=Math.round(r*s),r|=0;let h=0;for(let s of e){let e=0;for(let h=0;s.t.length>h;h++){const o=s.t[h];if(!o)continue;const a=o.length*t;if(r===e){const t=s.o(o);n.push(t)}if(e+=a,e>r)break}}for(let t=0;n.length>t;++t){let r=n[t]();void 0!==r?h+=r:n.splice(t--,1)}return h/8};class m extends AudioWorkletProcessor{m=!1;paused=!1;playbackRate=1;i=0;k=128;sampleCount=o[0].h*t;constructor(){super(),this.port.onmessage=t=>{const{name:r}=t.data;switch(r){case"start":this.m=!0;break;case"pause":this.paused=!0;break;case"unpause":this.paused=!1}}}process(r,s,n){if(this.paused)return s[0][0].fill(0),!0;const m=s[0][0],i=this.i,c=this.i+this.k;for(let t=i;c>t;t++)m[t-i]=a(t,this.playbackRate,o);return this.i=c,this.i>this.sampleCount/this.playbackRate&&(this.i=0,this.m&&(o=[e,h],this.sampleCount=o[0].h*t)),!0}}registerProcessor("music-processor",m);